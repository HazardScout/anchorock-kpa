"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.KPAProcoreConfigurationDB = void 0;
const mongodb_1 = require("mongodb");
const mongodb_2 = require("../../../base-integration/src/mongodb");
const model_1 = require("../model");
class KPAProcoreConfigurationDB extends mongodb_2.KPABaseConfigurationDB {
    constructor() {
        super();
        this.collectionName = 'procoreconfigs';
    }
    convertData(data) {
        return new model_1.KPAProcoreConfigurationModel(data);
    }
    async updateProcoreToken(data) {
        const mongoClient = await mongodb_1.MongoClient.connect(this.mongoDbUrl);
        const mongoDb = mongoClient.db();
        let mongoDbCollection = mongoDb.collection(this.collectionName);
        await mongoDbCollection.updateOne({ kpa_token: data.kpaToken }, { $set: {
                procore_token: data.procoreToken,
                procore_refresh_token: data.procoreRefreshToken
            } });
        await mongoClient.close();
        return data;
    }
}
exports.KPAProcoreConfigurationDB = KPAProcoreConfigurationDB;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia3BhLXByb2NvcmUtY29uZmlndXJhdGlvbi1kYi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2NvcmUtaW50ZWdyYXRpb24vZnVuY3Rpb24vbW9uZ29kYi9rcGEtcHJvY29yZS1jb25maWd1cmF0aW9uLWRiLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHFDQUFnRDtBQUNoRCxtRUFBK0U7QUFDL0Usb0NBQXdEO0FBRXhELE1BQWEseUJBQTBCLFNBQVEsZ0NBQW9EO0lBRy9GO1FBQ0ksS0FBSyxFQUFFLENBQUE7UUFDUCxJQUFJLENBQUMsY0FBYyxHQUFHLGdCQUFnQixDQUFDO0lBQzNDLENBQUM7SUFFRCxXQUFXLENBQUMsSUFBYztRQUN0QixPQUFPLElBQUksb0NBQTRCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUVELEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxJQUFrQztRQUN2RCxNQUFNLFdBQVcsR0FBRyxNQUFNLHFCQUFXLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUMvRCxNQUFNLE9BQU8sR0FBRyxXQUFXLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDakMsSUFBSSxpQkFBaUIsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUVoRSxNQUFNLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFDLEVBQUUsRUFBQyxJQUFJLEVBQUU7Z0JBQ2pFLGFBQWEsRUFBRSxJQUFJLENBQUMsWUFBWTtnQkFDaEMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLG1CQUFtQjthQUNsRCxFQUFDLENBQUMsQ0FBQztRQUVKLE1BQU0sV0FBVyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQzFCLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Q0FDSjtBQXpCRCw4REF5QkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEb2N1bWVudCwgTW9uZ29DbGllbnQgfSBmcm9tIFwibW9uZ29kYlwiO1xuaW1wb3J0IHsgS1BBQmFzZUNvbmZpZ3VyYXRpb25EQiB9IGZyb20gXCIuLi8uLi8uLi9iYXNlLWludGVncmF0aW9uL3NyYy9tb25nb2RiXCI7XG5pbXBvcnQgeyBLUEFQcm9jb3JlQ29uZmlndXJhdGlvbk1vZGVsIH0gZnJvbSBcIi4uL21vZGVsXCI7XG5cbmV4cG9ydCBjbGFzcyBLUEFQcm9jb3JlQ29uZmlndXJhdGlvbkRCIGV4dGVuZHMgS1BBQmFzZUNvbmZpZ3VyYXRpb25EQjxLUEFQcm9jb3JlQ29uZmlndXJhdGlvbk1vZGVsPiB7XG4gICAgY29sbGVjdGlvbk5hbWU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpXG4gICAgICAgIHRoaXMuY29sbGVjdGlvbk5hbWUgPSAncHJvY29yZWNvbmZpZ3MnO1xuICAgIH1cblxuICAgIGNvbnZlcnREYXRhKGRhdGE6IERvY3VtZW50KTogS1BBUHJvY29yZUNvbmZpZ3VyYXRpb25Nb2RlbCB7XG4gICAgICAgIHJldHVybiBuZXcgS1BBUHJvY29yZUNvbmZpZ3VyYXRpb25Nb2RlbChkYXRhKTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVQcm9jb3JlVG9rZW4oZGF0YTogS1BBUHJvY29yZUNvbmZpZ3VyYXRpb25Nb2RlbCkgOiBQcm9taXNlPEtQQVByb2NvcmVDb25maWd1cmF0aW9uTW9kZWw+IHtcbiAgICAgICAgY29uc3QgbW9uZ29DbGllbnQgPSBhd2FpdCBNb25nb0NsaWVudC5jb25uZWN0KHRoaXMubW9uZ29EYlVybCk7XG4gICAgICAgIGNvbnN0IG1vbmdvRGIgPSBtb25nb0NsaWVudC5kYigpO1xuICAgICAgICBsZXQgbW9uZ29EYkNvbGxlY3Rpb24gPSBtb25nb0RiLmNvbGxlY3Rpb24odGhpcy5jb2xsZWN0aW9uTmFtZSk7XG5cbiAgICAgICAgYXdhaXQgbW9uZ29EYkNvbGxlY3Rpb24udXBkYXRlT25lKHtrcGFfdG9rZW46IGRhdGEua3BhVG9rZW59LCB7JHNldDoge1xuICAgICAgICAgICAgcHJvY29yZV90b2tlbjogZGF0YS5wcm9jb3JlVG9rZW4sXG4gICAgICAgICAgICBwcm9jb3JlX3JlZnJlc2hfdG9rZW46IGRhdGEucHJvY29yZVJlZnJlc2hUb2tlblxuICAgICAgICB9fSk7XG5cbiAgICAgICAgYXdhaXQgbW9uZ29DbGllbnQuY2xvc2UoKTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxufVxuIl19